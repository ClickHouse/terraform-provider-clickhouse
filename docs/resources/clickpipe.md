---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "clickhouse_clickpipe Resource - clickhouse"
subcategory: ""
description: |-
  The ClickPipe resource allows you to create and manage ClickPipes data ingestion in ClickHouse Cloud.
---

# clickhouse_clickpipe (Resource)

The ClickPipe resource allows you to create and manage ClickPipes data ingestion in ClickHouse Cloud.

## Example Usage

```terraform
resource "clickhouse_clickpipe" "kafka_clickpipe" {
  name           = "My Kafka ClickPipe"
  description    = "Data pipeline from Kafka to ClickHouse"

  service_id     = "e9465b4b-f7e5-4937-8e21-8d508b02843d"

  scaling {
    replicas = 1
  }

  state = "Running"

  source {
    kafka {
      type = "confluent"
      format = "JSONEachRow"
      brokers = "my-kafka-broker:9092"
      topics = "my_topic"

      consumer_group = "clickpipe-test"

      credentials {
        username = "user"
        password = "***"
      }
    }
  }

  destination {
    table    = "my_table"
    managed_table = true
    
    tableDefinition {
      engine {
        type = "MergeTree"
      }
    }

    columns {
      name = "my_field1"
      type = "String"
    }

    columns {
      name = "my_field2"
      type = "UInt64"
    }
  }

  field_mappings = [
    {
      source_field = "my_field"
      destination_field = "my_field1"
    }
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `destination` (Attributes) The destination for the ClickPipe. (see [below for nested schema](#nestedatt--destination))
- `name` (String) The name of the ClickPipe.
- `service_id` (String) The ID of the service to which the ClickPipe belongs.
- `source` (Attributes) The data source for the ClickPipe. (see [below for nested schema](#nestedatt--source))

### Optional

- `description` (String) The description of the ClickPipe.
- `field_mappings` (Attributes List) Field mapping between source and destination table. (see [below for nested schema](#nestedatt--field_mappings))
- `scaling` (Attributes) (see [below for nested schema](#nestedatt--scaling))
- `state` (String) The state of the ClickPipe. (`Running`, `Stopped`). Default is `Running`. Whenever the pipe state changes, the Terraform provider will try to ensure the actual state matches the planned value. If pipe is `Failed` and plan is `Running`, the provider will try to resume the pipe. If plan is `Stopped`, the provider will try to stop the pipe. If the pipe is `InternalError`, no action will be taken.

### Read-Only

- `id` (String) The ID of the ClickPipe. Generated by the ClickHouse Cloud.

<a id="nestedatt--destination"></a>
### Nested Schema for `destination`

Required:

- `columns` (Attributes List) The list of columns for the ClickHouse table. (see [below for nested schema](#nestedatt--destination--columns))
- `table` (String) The name of the ClickHouse table.

Optional:

- `database` (String) The name of the ClickHouse database. Default is `default`.
- `managed_table` (Boolean) Whether the table is managed by ClickHouse Cloud. If `false`, the table must exist in the database. Default is `true`.
- `roles` (List of String) ClickPipe will create a ClickHouse user with these roles. Add your custom roles here if required.
- `table_definition` (Attributes) Definition of the destination table. Required for ClickPipes managed tables. (see [below for nested schema](#nestedatt--destination--table_definition))

<a id="nestedatt--destination--columns"></a>
### Nested Schema for `destination.columns`

Required:

- `name` (String) The name of the column.
- `type` (String) The type of the column.


<a id="nestedatt--destination--table_definition"></a>
### Nested Schema for `destination.table_definition`

Required:

- `engine` (Attributes) The engine of the ClickHouse table. (see [below for nested schema](#nestedatt--destination--table_definition--engine))

Optional:

- `partition_by` (String) The column to partition the table by.
- `primary_key` (String) The primary key of the table.
- `sorting_key` (List of String) The list of columns for the sorting key.

<a id="nestedatt--destination--table_definition--engine"></a>
### Nested Schema for `destination.table_definition.engine`

Required:

- `type` (String) The type of the engine. Only `MergeTree` is supported.




<a id="nestedatt--source"></a>
### Nested Schema for `source`

Optional:

- `kafka` (Attributes) (see [below for nested schema](#nestedatt--source--kafka))

<a id="nestedatt--source--kafka"></a>
### Nested Schema for `source.kafka`

Required:

- `brokers` (String) The list of Kafka bootstrap brokers. (comma separated)
- `credentials` (Attributes) The credentials for the Kafka source. (see [below for nested schema](#nestedatt--source--kafka--credentials))
- `format` (String) The format of the Kafka source. (`JSONEachRow`, `Avro`, `AvroConfluent`)
- `topics` (String) The list of Kafka topics. (comma separated)

Optional:

- `authentication` (String) The authentication method for the Kafka source. (`PLAIN`, `SCRAM-SHA-256`, `SCRAM-SHA-512`, `IAM_ROLE`, `IAM_USER`). Default is `PLAIN`.
- `ca_certificate` (String) PEM encoded CA certificates to validate the broker's certificate.
- `consumer_group` (String) Consumer group of the Kafka source. If not provided `clickpipes-<ID>` will be used.
- `iam_role` (String) The IAM role for the Kafka source. Use with `IAM_ROLE` authentication. Read more in [ClickPipes documentation page](https://clickhouse.com/docs/en/integrations/clickpipes/kafka#iam)
- `offset` (Attributes) The Kafka offset. (see [below for nested schema](#nestedatt--source--kafka--offset))
- `schema_registry` (Attributes) The schema registry for the Kafka source. (see [below for nested schema](#nestedatt--source--kafka--schema_registry))
- `type` (String) The type of the Kafka source. (`kafka`, `redpanda`, `confluent`, `msk`, `warpstream`, `azureeventhub`). Default is `kafka`.

<a id="nestedatt--source--kafka--credentials"></a>
### Nested Schema for `source.kafka.credentials`

Optional:

- `access_key_id` (String, Sensitive) The access key ID for the Kafka source. Use with `IAM_USER` authentication.
- `connection_string` (String, Sensitive) The connection string for the Kafka source. Use with `azureeventhub` Kafka source type. Use with `PLAIN` authentication.
- `password` (String, Sensitive) The password for the Kafka source.
- `secret_key` (String, Sensitive) The secret key for the Kafka source. Use with `IAM_USER` authentication.
- `username` (String, Sensitive) The username for the Kafka source.


<a id="nestedatt--source--kafka--offset"></a>
### Nested Schema for `source.kafka.offset`

Required:

- `strategy` (String) The offset strategy for the Kafka source. (`from_beginning`, `from_latest`, `from_timestamp`)

Optional:

- `timestamp` (String) The timestamp for the Kafka offset. Use with `from_timestamp` offset strategy.


<a id="nestedatt--source--kafka--schema_registry"></a>
### Nested Schema for `source.kafka.schema_registry`

Required:

- `authentication` (String) The authentication method for the Schema Registry. Only supported is `PLAIN`.
- `credentials` (Attributes) The credentials for the Schema Registry. (see [below for nested schema](#nestedatt--source--kafka--schema_registry--credentials))
- `url` (String) The URL of the schema registry.

<a id="nestedatt--source--kafka--schema_registry--credentials"></a>
### Nested Schema for `source.kafka.schema_registry.credentials`

Required:

- `password` (String, Sensitive) The password for the Schema Registry.
- `username` (String, Sensitive) The username for the Schema Registry.





<a id="nestedatt--field_mappings"></a>
### Nested Schema for `field_mappings`

Required:

- `destination_field` (String) The name of the column in destination table.
- `source_field` (String) The name of the source field.


<a id="nestedatt--scaling"></a>
### Nested Schema for `scaling`

Optional:

- `replicas` (Number) The number of desired replicas for the ClickPipe. Default is 1. The maximum value is 10.
