---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "clickhouse Provider"
subcategory: ""
description: |-
  This is the official provider for ClickHouse Cloud.
  With this provider you can deploy a ClickHouse instance on AWS, Google Cloud or Azure Cloud.
  To use this provider, you need to Sign In https://clickhouse.cloud/signIn for a ClickHouse Cloud account and generate an API key https://clickhouse.com/docs/en/cloud/manage/openapi.
  You can find more example on how to use this provider on Github https://github.com/ClickHouse/terraform-provider-clickhouse/tree/main/examples/full.
  Visit https://clickhouse.com/docs/en/cloud-quick-start https://clickhouse.com/docs/en/cloud-quick-start now to get started using ClickHouse Cloud.
  Breaking changes
  Upgrading to version >= 1.0.0 of the Clickhouse Terraform Provider
  If you are upgrading from version < 1.0.0 to anything >= 1.0.0 and you are using the clickhouse_private_endpoint_registration resource or the private_endpoint_ids attribute of the clickhouse_service resource,
  then a manual process is required after the upgrade.
  In the clickhouse_private_endpoint_registration resource, rename the id attribute to private_endpoint_id.
  Before:
  
  resource "clickhouse_private_endpoint_registration" "example" {
    id = aws_vpc_endpoint.pl_vpc_foo.id
    ...
  }
  
  After:
  
  resource "clickhouse_private_endpoint_registration" "example" {
    private_endpoint_id = aws_vpc_endpoint.pl_vpc_foo.id
    ...
  }
  
  If you used the private_endpoint_ids in any of the clickhouse_service resources
  For each service with private_endpoint_ids attribute set:
  2a) Create a new clickhouse_service_private_endpoints_attachment resource  like this:
  
  resource "clickhouse_service_private_endpoints_attachment" "example" {
    # The ID of the service with the `private_endpoint_ids` set
    service_id = clickhouse_service.aws_red.id
  
    # the same attribute you previously defined in the `clickhouse_service` resource goes here now
    # Remember to change `id` with `private_endpoint_id` in the `clickhouse_private_endpoint_registration` reference.
    private_endpoint_ids = [clickhouse_private_endpoint_registration.example.private_endpoint_id]
  }
  
  2b) Remove the private_endpoint_ids attribute from the clickhouse_service resource.
  Example:
  Before:
  
  resource "clickhouse_service" "example" {
    ...
    private_endpoint_ids = [clickhouse_private_endpoint_registration.example.id]
  }
  
  After:
  
  resource "clickhouse_service" "example" {
    ...
  }
  
  resource "clickhouse_service_private_endpoints_attachment" "red_attachment" {
    private_endpoint_ids = [clickhouse_private_endpoint_registration.example.private_endpoint_id]
    service_id = clickhouse_service.example.id
  }
  
  2c) Import existing clickhouse_service_private_endpoints_attachment
  For each clickhouse_service_private_endpoints_attachment you created in step 2b, import existing state with
  
    terraform import clickhouse_service_private_endpoints_attachment.<name> <clickhouse service id>
---

# clickhouse Provider

# This is the official provider for ClickHouse Cloud.

With this provider you can deploy a ClickHouse instance on AWS, Google Cloud or Azure Cloud.

To use this provider, you need to [Sign In](https://clickhouse.cloud/signIn) for a ClickHouse Cloud account and generate an [API key](https://clickhouse.com/docs/en/cloud/manage/openapi).

You can find more example on how to use this provider on [Github](https://github.com/ClickHouse/terraform-provider-clickhouse/tree/main/examples/full).

Visit [https://clickhouse.com/docs/en/cloud-quick-start](https://clickhouse.com/docs/en/cloud-quick-start) now to get started using ClickHouse Cloud.

## Breaking changes

### Upgrading to version >= 1.0.0 of the Clickhouse Terraform Provider

If you are upgrading from version < 1.0.0 to anything >= 1.0.0 and you are using the `clickhouse_private_endpoint_registration` resource or the `private_endpoint_ids` attribute of the `clickhouse_service` resource,
then a manual process is required after the upgrade.

1) In the `clickhouse_private_endpoint_registration` resource, rename the `id` attribute to `private_endpoint_id`.

Before:

```
resource "clickhouse_private_endpoint_registration" "example" {
  id = aws_vpc_endpoint.pl_vpc_foo.id
  ...
}
```

After:

```
resource "clickhouse_private_endpoint_registration" "example" {
  private_endpoint_id = aws_vpc_endpoint.pl_vpc_foo.id
  ...
}
```

2) If you used the `private_endpoint_ids` in any of the `clickhouse_service` resources

For each service with `private_endpoint_ids` attribute set:

2a) Create a new `clickhouse_service_private_endpoints_attachment` resource  like this:

```
resource "clickhouse_service_private_endpoints_attachment" "example" {
  # The ID of the service with the `private_endpoint_ids` set
  service_id = clickhouse_service.aws_red.id

  # the same attribute you previously defined in the `clickhouse_service` resource goes here now
  # Remember to change `id` with `private_endpoint_id` in the `clickhouse_private_endpoint_registration` reference.
  private_endpoint_ids = [clickhouse_private_endpoint_registration.example.private_endpoint_id]
}
```

2b) Remove the `private_endpoint_ids` attribute from the `clickhouse_service` resource.

Example: 

Before:

```
resource "clickhouse_service" "example" {
  ...
  private_endpoint_ids = [clickhouse_private_endpoint_registration.example.id]
}
```

After:

```
resource "clickhouse_service" "example" {
  ...
}

resource "clickhouse_service_private_endpoints_attachment" "red_attachment" {
  private_endpoint_ids = [clickhouse_private_endpoint_registration.example.private_endpoint_id]
  service_id = clickhouse_service.example.id
}
```

2c) Import existing `clickhouse_service_private_endpoints_attachment`

For each `clickhouse_service_private_endpoints_attachment` you created in step 2b, import existing state with

```
  terraform import clickhouse_service_private_endpoints_attachment.<name> <clickhouse service id>
```

## Example Usage

```terraform
# Configuration-based authentication
# these keys are for example only and won't work when pointed to a deployed ClickHouse OpenAPI server
provider "clickhouse" {
  organization_id = "aee076c1-3f83-4637-95b1-ad5a0a825b71"
  token_key       = "avhj1U5QCdWAE9CA9"
  token_secret    = "4b1dROiHQEuSXJHlV8zHFd0S7WQj7CGxz5kGJeJnca"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `api_url` (String) API URL of the ClickHouse OpenAPI the provider will interact with. Alternatively, can be configured using the `CLICKHOUSE_API_URL` environment variable. Only specify if you have a specific deployment of the ClickHouse OpenAPI you want to run against.
- `organization_id` (String) ID of the organization the provider will create services under. Alternatively, can be configured using the `CLICKHOUSE_ORG_ID` environment variable.
- `token_key` (String) Token key of the key/secret pair. Used to authenticate with OpenAPI. Alternatively, can be configured using the `CLICKHOUSE_TOKEN_KEY` environment variable.
- `token_secret` (String, Sensitive) Token secret of the key/secret pair. Used to authenticate with OpenAPI. Alternatively, can be configured using the `CLICKHOUSE_TOKEN_SECRET` environment variable.
